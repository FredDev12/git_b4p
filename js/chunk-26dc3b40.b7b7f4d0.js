(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26dc3b40"],{4601:function(e,t,n){"use strict";n.r(t);var c=n("7a23");const l={class:"dashboard"},o={class:"dashboard-container"},r={class:"user-profile"},a={key:0,class:"user-profile"},i={key:0},s=["onClick"],d=["onClick"],u={key:1,class:"user-profile"},b=["onClick"],m=["onClick"],O={key:2,class:"user-profile"},j=["onClick"],k=["onClick"];function p(e,t,n,p,E,g){const h=Object(c["resolveComponent"])("NavBar");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",l,[Object(c["createVNode"])(h,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),Object(c["createElementVNode"])("main",o,[Object(c["createElementVNode"])("div",null,[Object(c["createElementVNode"])("h1",null,"Bienvenue sur le tableau de bord, "+Object(c["toDisplayString"])(e.name)+" ("+Object(c["toDisplayString"])(e.role)+") !",1)]),Object(c["createElementVNode"])("section",r,[t[1]||(t[1]=Object(c["createElementVNode"])("h2",null,"Profil Utilisateur",-1)),Object(c["createElementVNode"])("table",null,[t[0]||(t[0]=Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"Nom"),Object(c["createElementVNode"])("th",null,"Rôle"),Object(c["createElementVNode"])("th",null,"Contract"),Object(c["createElementVNode"])("th",null,"Description")],-1)),Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.store.userProfile.name),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.store.userProfile.role),1),Object(c["createElementVNode"])("td",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.userContract,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.name||"Pas de contrat"),1)]))),128))]),Object(c["createElementVNode"])("td",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.store.userProfile.contracts,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.description||"Pas de description"),1)]))),128))])])])]),"Client"!==e.role?(Object(c["openBlock"])(),Object(c["createElementBlock"])("section",a,[t[4]||(t[4]=Object(c["createElementVNode"])("h2",null,"Clients",-1)),Object(c["createElementVNode"])("table",null,[Object(c["createElementVNode"])("tr",null,[t[2]||(t[2]=Object(c["createElementVNode"])("th",null,"Nom",-1)),t[3]||(t[3]=Object(c["createElementVNode"])("th",null,"Contrat",-1)),"Manager"!==e.role&&"Utilisateur"!==e.role?(Object(c["openBlock"])(),Object(c["createElementBlock"])("th",i,"Actions")):Object(c["createCommentVNode"])("",!0)]),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.clientList,t=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.name),1),Object(c["createElementVNode"])("td",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.contracts,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.name||"Pas de contrat"),1)]))),128))]),Object(c["createElementVNode"])("td",null,["Manager"!==e.role&&"Utilisateur"!==e.role?(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:0,onClick:n=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,s)):Object(c["createCommentVNode"])("",!0),"Manager"!==e.role&&"Utilisateur"!==e.role?(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:1,onClick:n=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,d)):Object(c["createCommentVNode"])("",!0)])]))),128))])])):Object(c["createCommentVNode"])("",!0),"Manager"!==e.role?(Object(c["openBlock"])(),Object(c["createElementBlock"])("section",u,[t[6]||(t[6]=Object(c["createElementVNode"])("h2",null,"Managers",-1)),Object(c["createElementVNode"])("table",null,[t[5]||(t[5]=Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"Nom"),Object(c["createElementVNode"])("th",null,"Contrat")],-1)),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.managerList,t=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.name),1),Object(c["createElementVNode"])("td",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.contracts,t=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t.id},[Object(c["createElementVNode"])("td",null,[Object(c["createTextVNode"])(Object(c["toDisplayString"])(t.name||"Pas de contrat")+" ",1),Object(c["createElementVNode"])("button",{onClick:n=>e.editContract(t.id),class:"edit-button"},"Éditer",8,b),Object(c["createElementVNode"])("button",{onClick:n=>e.deleteContract(t.id),class:"delete-button"},"Supprimer",8,m)])]))),128))])]))),128))])])):Object(c["createCommentVNode"])("",!0),"Utilisateur"!==e.role?(Object(c["openBlock"])(),Object(c["createElementBlock"])("section",O,[t[8]||(t[8]=Object(c["createElementVNode"])("h2",null,"Utilisateurs",-1)),Object(c["createElementVNode"])("table",null,[t[7]||(t[7]=Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"Nom"),Object(c["createElementVNode"])("th",null,"Manager"),Object(c["createElementVNode"])("th",null,"Contrat"),Object(c["createElementVNode"])("th",null,"Tache"),Object(c["createElementVNode"])("th",null,"Status"),Object(c["createElementVNode"])("th",null,"Actions")],-1)),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.utilisateurList,t=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.name),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.store.users.find(e=>t.managerId.includes(e.id))?e.store.users.find(e=>t.managerId.includes(e.id)).name:"Manager Inconnu"),1),Object(c["createElementVNode"])("td",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.contracts,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.name||"Pas de contrat"),1)]))),128))]),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.task||"Pas de tache"),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.status),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("button",{onClick:n=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,j),Object(c["createElementVNode"])("button",{onClick:n=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,k)])]))),128))])])):Object(c["createCommentVNode"])("",!0)])])}var E=n("6605"),g=n("5d04"),h=n("e4c3"),N=n("8c07"),V=n("d000"),f=n("3a50"),B=Object(c["defineComponent"])({name:"Dashboard",components:{ButtonComponent:h["a"],SidebarComponent:N["a"],NavBar:V["a"]},data(){return{filteredMenuItems:[],username:"Invité",role:"User"}},setup(){const e=Object(E["c"])(),t=Object(g["a"])(),n=Object(c["ref"])([]),l=Object(c["ref"])(""),o=t.userProfile?t.userProfile.name:"Default Name",r=localStorage.getItem("role")||"Utilisateur",a=localStorage.getItem("token"),i=t.isAuthenticated;let s,d,u;const b=t.userProfile.contracts.map(e=>({id:e.id,name:e.name,description:e.description,userId:e.userId}||[]));t.users.map(e=>({id:e.id,name:e.name,email:e.email,role:e.role,clientId:e.clientId,managerId:e.managerId,utilisateurId:e.utilisateurId,status:e.status,task:e.task,contracts:e.contracts.map(e=>({id:e.id,name:e.name,description:e.description,userId:e.userId}))||[]}));t.users?(s=t.users.filter(e=>"Client"===e.role),d=t.users.filter(e=>"Manager"===e.role),u=t.users.filter(e=>"Utilisateur"===e.role)):console.error("store.users is undefined"),console.log("\n\n\n\n",b,"\n\n\n"),console.log("\n\n\n\n client",s,"\n\n\n"),console.log("\n\n\n\n",t.users,"\n\n\n");const m=Object(c["ref"])([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Mon Profil",link:"/profile",active:!0,visibleTo:["Admin","Client","Manager","Utilisateur"]}]),O=m.value.filter(e=>e.visibleTo.includes(r));Object(c["onMounted"])(async()=>{if(a){console.log(o,"-",r);const e=await Object(f["c"])(r,a);n.value=e,console.log("storage",e)}else console.error("authentication token is missing")});const j=e=>{console.log("Edit entity:",e)},k=e=>{console.log("Delete entity with ID:",e)},p=e=>{console.log("Editing client:",e)},h=e=>{console.log("Editing client:",e)},N=async()=>{e.push({name:"Login"})};return{name:o,role:r,menuItems:m,filteredMenuItems:O,utilisateurList:u,userContract:b,entities:n,entityTitle:l,editEntity:j,deleteEntity:k,editContract:p,deleteContract:h,isAuthenticated:i,logout:N,clientList:s,managerList:d,store:t}}}),y=n("6b0d"),C=n.n(y);const v=C()(B,[["render",p]]);t["default"]=v},"5d04":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var c=n("be92"),l=n("3a50");const o=Object(c["b"])({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const n=await Object(l["d"])(e,t),c=n.token,o=n.role;this.token=c,localStorage.setItem("token",c),localStorage.setItem("role",o),this.isAuthenticated=!0,await this.fetchUserProfile(c),await this.fetchUsers(o,c)}catch(n){throw console.error("Authentication failed:",n),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await Object(l["a"])(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const n=await Object(l["c"])(e,t);console.log("storage",n),this.users=n,console.log(this.users)}catch(n){console.error("Failed to fetch user:",n),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const n=await Object(l["b"])(e,t);console.log("storage",n),this.userList=n,console.log("liste ",this.userList)}catch(n){console.error("Failed to fetch user:",n),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await Object(l["e"])(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await Object(l["c"])(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})},"8c07":function(e,t,n){"use strict";var c=n("7a23");const l={class:"sidebar"},o=["href"];function r(e,t,n,r,a,i){return Object(c["openBlock"])(),Object(c["createElementBlock"])("aside",l,[Object(c["createElementVNode"])("nav",null,[Object(c["createElementVNode"])("ul",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.menuItems,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("li",{key:e.name,class:Object(c["normalizeClass"])({active:e.active})},[Object(c["createElementVNode"])("a",{href:e.link},Object(c["toDisplayString"])(e.name),9,o)],2))),128))])])])}var a=Object(c["defineComponent"])({name:"SidebarComponent",props:{menuItems:{type:Array,required:!0}}}),i=(n("9261"),n("6b0d")),s=n.n(i);const d=s()(a,[["render",r],["__scopeId","data-v-74b7da77"]]);t["a"]=d},9261:function(e,t,n){"use strict";n("d558")},d000:function(e,t,n){"use strict";var c=n("7a23");const l={class:"navbar"};function o(e,t,n,o,r,a){const i=Object(c["resolveComponent"])("router-link");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("header",l,[t[1]||(t[1]=Object(c["createElementVNode"])("div",{class:"logo"},[Object(c["createElementVNode"])("a",{href:"/"},"MonLogo")],-1)),Object(c["createElementVNode"])("div",{class:Object(c["normalizeClass"])(["menu",{active:e.isMenuOpen}])},[Object(c["createElementVNode"])("ul",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.menuItems,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("li",{key:e.name,class:Object(c["normalizeClass"])({active:e.active})},[Object(c["createVNode"])(i,{class:"link",to:e.link},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.name),1)]),_:2},1032,["to"])],2))),128))])],2),Object(c["createElementVNode"])("div",{class:Object(c["normalizeClass"])(["menu",{active:e.isMenuOpen}])},[Object(c["createElementVNode"])("ul",null,[Object(c["createElementVNode"])("li",null,[Object(c["createElementVNode"])("a",{href:"#",onClick:t[0]||(t[0]=Object(c["withModifiers"])((...t)=>e.logout&&e.logout(...t),["prevent"]))},"Déconnexion")])])],2)])])}var r=n("6605"),a=Object(c["defineComponent"])({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=Object(r["c"])(),t=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")};return{logout:t}},data(){return{isMenuOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen}}}),i=n("6b0d"),s=n.n(i);const d=s()(a,[["render",o]]);t["a"]=d},d558:function(e,t,n){}}]);
//# sourceMappingURL=chunk-26dc3b40.b7b7f4d0.js.map