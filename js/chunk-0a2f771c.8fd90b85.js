(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a2f771c"],{"50d5":function(e,t,o){e.exports=o.p+"img/wadoria.673e5e7d.png"},"5d04":function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var r=o("be92"),a=o("3a50");const l=Object(r["b"])({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const o=await Object(a["d"])(e,t),r=o.token,l=o.role;this.token=r,localStorage.setItem("token",r),localStorage.setItem("role",l),this.isAuthenticated=!0,await this.fetchUserProfile(r),await this.fetchUsers(l,r)}catch(o){throw console.error("Authentication failed:",o),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await Object(a["a"])(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const o=await Object(a["c"])(e,t);console.log("storage",o),this.users=o,console.log(this.users)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const o=await Object(a["b"])(e,t);console.log("storage",o),this.userList=o,console.log("liste ",this.userList)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await Object(a["e"])(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await Object(a["c"])(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})},8192:function(e,t,o){"use strict";var r=o("7a23");const a={class:"input-field"},l=["for"],n=["id","type","value","placeholder","disabled","maxlength","minlength"],s={key:1,class:"error-message"};function c(e,t,o,c,i,d){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",a,[e.label?(Object(r["openBlock"])(),Object(r["createElementBlock"])("label",{key:0,for:e.id,class:"input-label"},Object(r["toDisplayString"])(e.label),9,l)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("input",{id:e.id,type:e.type,value:e.modelValue,placeholder:e.placeholder,disabled:e.disabled,maxlength:e.maxlength,minlength:e.minlength,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),class:"input"},null,40,n),e.errorMessage?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",s,Object(r["toDisplayString"])(e.errorMessage),1)):Object(r["createCommentVNode"])("",!0)])}var i=Object(r["defineComponent"])({name:"InputField",props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,default:"text"},modelValue:{type:String,required:!0},placeholder:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1},maxlength:{type:Number,required:!1},minlength:{type:Number,required:!1},errorMessage:{type:String,required:!1}}}),d=(o("be8d"),o("6b0d")),u=o.n(d);const p=u()(i,[["render",c],["__scopeId","data-v-424e3b7f"]]);t["a"]=p},a55b:function(e,t,o){"use strict";o.r(t);var r=o("7a23"),a=o("50d5"),l=o.n(a);const n={class:"login-container"},s={class:"form-group"},c={key:0,class:"error"};function i(e,t,o,a,i,d){const u=Object(r["resolveComponent"])("InputField"),p=Object(r["resolveComponent"])("ButtonComponent"),m=Object(r["resolveComponent"])("router-link");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",n,[t[4]||(t[4]=Object(r["createElementVNode"])("img",{src:l.a,alt:"Logo",class:"logo"},null,-1)),t[5]||(t[5]=Object(r["createElementVNode"])("h1",null,"Connexion",-1)),Object(r["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(r["withModifiers"])((...t)=>e.handleLogin&&e.handleLogin(...t),["prevent"]))},[Object(r["createElementVNode"])("div",s,[Object(r["createVNode"])(u,{type:"email",id:"email",modelValue:e.email,"onUpdate:modelValue":t[0]||(t[0]=t=>e.email=t),label:"Email","error-message":e.emailError,placeholder:"Entrez votre email",required:""},null,8,["modelValue","error-message"]),Object(r["createVNode"])(u,{type:"password",id:"password",modelValue:e.password,"onUpdate:modelValue":t[1]||(t[1]=t=>e.password=t),label:"Mot de passe","error-message":e.passwordError,placeholder:"Entrez votre mot de passe",required:""},null,8,["modelValue","error-message"])]),Object(r["createVNode"])(p,{type:"submit",class:"btn-primary",disabled:e.loading},{default:Object(r["withCtx"])(()=>[e.loading?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Object(r["createTextVNode"])("Chargement...")],64)):(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:1},[Object(r["createTextVNode"])("Se connecter")],64))]),_:1},8,["disabled"]),e.apiError?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",c,Object(r["toDisplayString"])(e.apiError),1)):Object(r["createCommentVNode"])("",!0)],32),Object(r["createElementVNode"])("p",null,[Object(r["createVNode"])(m,{to:"/requestPasswordReset"},{default:Object(r["withCtx"])(()=>t[3]||(t[3]=[Object(r["createTextVNode"])("Mot de passe oublié ?")])),_:1})])])}var d=o("6605"),u=o("5d04"),p=o("e4c3"),m=o("8192"),b=Object(r["defineComponent"])({name:"Login",components:{ButtonComponent:p["a"],InputField:m["a"]},setup(){const e=Object(d["c"])(),t=Object(u["a"])(),o=Object(r["ref"])(""),a=Object(r["ref"])(""),l=Object(r["ref"])(""),n=Object(r["ref"])(""),s=Object(r["ref"])(""),c=Object(r["ref"])(!1),i=async()=>{if(c.value=!0,l.value="",n.value="",s.value="",!p(o.value))return l.value="Veuillez entrer une adresse email valide.",void(c.value=!1);if(a.value.length<6)return n.value="Le mot de passe doit contenir au moins 6 caractères.",void(c.value=!1);try{await t.performLogin(o.value,a.value),e.push({name:"Dashboard"})}catch(r){console.error(r),s.value=r.message||"Role non reconnu."}finally{c.value=!1}},p=e=>{const t=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;return t.test(e)};return{email:o,password:a,emailError:l,passwordError:n,apiError:s,handleLogin:i,loading:c}}}),h=o("6b0d"),g=o.n(h);const f=g()(b,[["render",i]]);t["default"]=f},be8d:function(e,t,o){"use strict";o("d2e2")},d2e2:function(e,t,o){}}]);
//# sourceMappingURL=chunk-0a2f771c.8fd90b85.js.map